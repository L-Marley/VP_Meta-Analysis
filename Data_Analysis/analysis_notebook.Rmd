---
title: "Visual Perspective - Meta-Analysis"
author: Liam Marley
output: html_notebook:
  theme: flatly
  toc: yes
---

```{r, include=FALSE}
knitr::opts_chunk$set(tidy.opts = list(width.cutoff=60), tidy = TRUE)
```

# Packages Used
```{r packages}
library(tidyverse)
library(metafor)
```

# Data Import and Tidying

## Load in the data
```{r data_loading}
qual_export <- read_csv("qual_export_24-07-18.csv")
```

## Data Tidying

Following chunk drops: the unecessary qualtrics variables and rows, correlational studies, and any research conducted at the memory level.

Correlational studies are dropped to be analysed separately, and studies done at the memory level have nearly always used single level statistics treating memories as participants. Which ignores the clustering and dependency in the data leading to spurious results. As such, they've been excluded as a form of quality control.

```{r}
qual_tidy <- 
  qual_export %>%
  select(-c(`Start Date`:`User Language`)) %>%
  filter(Analysis_Level == "Participants") %>%
  filter(Design_1 == "Experimental")
```

### Extract vividness data

Only selects the variables to calculate effect sizes from and those that are necessary to identify the research source and potential moderators (emotional cues and clinical samples). 
Then renames these to variables more suited for conducting the analysis
Finally, it drops studies with any na values within these variables. Note, this will only drop studies that have no vividness scores not those with missing data because missing data has been coded as -99 within qualtrics. 

```{r}
vivid_dat <- 
  qual_tidy %>%
  select(Pub_ID:Study_ID, `Clinical_Mod - Selected Choice`, Emo_Mod, `Outcome - Vividness`, `Vividness - First_Mean`:`Vividness - Between_Test`, -c(`Vividness - First_Corr`, `Vividness - Third_Corr`, `Vividness - What was the correlation with [Field-1] perspective?`)) %>%
  rename(outcome = `Outcome - Vividness`, first_mean = `Vividness - First_Mean`, third_mean = `Vividness - Third_Mean`, first_sd = `Vividness - First_SD`, third_sd = `Vividness - Third_SD`, first_n = `Vividness - First_N`, third_n = `Vividness - Third_N`, clinical_mod = `Clinical_Mod - Selected Choice`) %>%
  drop_na()
```

